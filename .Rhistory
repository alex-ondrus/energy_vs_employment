?saveRDS
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(directlabels)
filter_unemployment_table <- function(){
unemployment <- read_csv("14100287.csv") %>%
filter(GEO != "Canada",
`Age group` == "15 years and over",
Statistics == "Estimate",
`Labour force characteristics` == "Unemployment rate",
Sex == "Both sexes", `Data type` == "Seasonally adjusted") %>%
select(REF_DATE, GEO, VALUE)
unemployment$Year <- substr(unemployment$REF_DATE, 1, 4) %>% as.numeric()
unemployment$Month <- substr(unemployment$REF_DATE, 6, 7) %>% as.numeric()
unemployment$REF_DATE <- NULL
saveRDS(unemployment, file = "unemployment_by_province_monthly.RDS")
}
filter_unemployment_table()
library(knitr)
kable(u_o_rsq)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(RColorBrewer)
library(knitr)
library(kableExtra)
filter_unemployment_table <- function(){
unemployment <- read_csv("14100287.csv") %>%
filter(GEO != "Canada",
`Age group` == "15 years and over",
Statistics == "Estimate",
`Labour force characteristics` == "Unemployment rate",
Sex == "Both sexes", `Data type` == "Seasonally adjusted") %>%
select(REF_DATE, GEO, VALUE)
unemployment$Year <- substr(unemployment$REF_DATE, 1, 4) %>% as.numeric()
unemployment$Month <- substr(unemployment$REF_DATE, 6, 7) %>% as.numeric()
unemployment$REF_DATE <- NULL
saveRDS(unemployment, file = "unemployment_by_province_monthly.RDS")
}
unemployment <- readRDS("unemployment_by_province_monthly.RDS")
oil <- read_csv("WTISPLC.csv")
oil$Month <- month(oil$DATE)
oil$Year <- year(oil$DATE)
unemployment_and_oil <- left_join(unemployment, oil, by = c("Year", "Month")) %>%
mutate(VALUE = VALUE / 100) %>%
drop_na()
colnames(unemployment_and_oil) <- c("Province", "Unemployment",
"Year", "Month", "Date", "Oil")
u_o_rsq <- unemployment_and_oil %>%
group_by(Province) %>%
summarise(rsq = cor(Oil, Unemployment)^2)
u_o_rsq$labels <- paste("R^2 ==", round(u_o_rsq$rsq, 2))
u_o_rsq$x <- 100
u_o_rsq$y <- 0.20
kable(u_o_rsq) %>% kable_styling(full_width = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(RColorBrewer)
library(knitr)
library(kableExtra)
filter_unemployment_table <- function(){
unemployment <- read_csv("14100287.csv") %>%
filter(GEO != "Canada",
`Age group` == "15 years and over",
Statistics == "Estimate",
`Labour force characteristics` == "Unemployment rate",
Sex == "Both sexes", `Data type` == "Seasonally adjusted") %>%
select(REF_DATE, GEO, VALUE)
unemployment$Year <- substr(unemployment$REF_DATE, 1, 4) %>% as.numeric()
unemployment$Month <- substr(unemployment$REF_DATE, 6, 7) %>% as.numeric()
unemployment$REF_DATE <- NULL
saveRDS(unemployment, file = "unemployment_by_province_monthly.RDS")
}
unemployment <- readRDS("unemployment_by_province_monthly.RDS")
oil <- read_csv("WTISPLC.csv")
oil$Month <- month(oil$DATE)
oil$Year <- year(oil$DATE)
unemployment_and_oil <- left_join(unemployment, oil, by = c("Year", "Month")) %>%
mutate(VALUE = VALUE / 100) %>%
drop_na()
colnames(unemployment_and_oil) <- c("Province", "Unemployment",
"Year", "Month", "Date", "Oil")
u_o_rsq <- unemployment_and_oil %>%
group_by(Province) %>%
summarise(rsq = cor(Oil, Unemployment)^2)
u_o_rsq$labels <- paste("R^2 ==", round(u_o_rsq$rsq, 2))
u_o_rsq$x <- 100
u_o_rsq$y <- 0.20
kable(u_o_rsq) %>% kable_styling(full_width = FALSE)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(colour = cut_width(Year, 10),
fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_colour_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(colour = cut_width(Year, 10),
fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_colour_manual(values = custom_palette) +
scale_fill_manual(values = custom_palette)
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
fill = NULL,
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(colour = cut_width(Year, 10),
fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_colour_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(colour = cut_width(Year, 10),
fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(colour = cut_width(Year, 10),
fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_colour_manual(values = custom_palette) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
lwd = 0.1) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
lwd = 0.5) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.5) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.1) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.1,
size = 0.9) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.1,
size = 1) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.2,
size = 1) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.5,
size = 1) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "grey",
stroke = 0.5,
size = 1.5) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "white",
stroke = 0.5,
size = 1.5) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "white",
stroke = 0.75,
size = 1.5) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
custom_palette <- brewer.pal(6, "YlOrRd")[2:6]
p <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "white") +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p)
p1 <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "white") +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
colour = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p1)
p1 <- ggplot(unemployment_and_oil, aes(x = Oil, y = Unemployment)) +
geom_point(aes(fill = cut_width(Year, 10)),
alpha = 0.6,
shape = 21,
colour = "white") +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap (~ Province, nrow = 2) +
scale_fill_manual(values = custom_palette) +
geom_text(data = u_o_rsq, aes(x = x, y = y, label = labels), parse = TRUE) +
labs(title = "Oil Price vs. Unemployment in Canadian Provinces",
subtitle = "How does the correlation differ in different regions?",
x = "WTI Crude Spot Price (USD)",
y = "Seasonally Adjusted Unemployment Rate",
fill = "Year",
caption = "Created by: Alexander Ondrus\nEmployment Data: Statistics Canada.  Table  14-10-0287-03\nLabour force characteristics by province, monthly, seasonally adjusted\nOil Prices: Federal Reserve Bank of St. Louis,\nSpot Crude Oil Price: West Texas Intermediate (WTI) [WTISPLC],\nretrieved from FRED, Federal Reserve Bank of St. Louis;\nhttps://fred.stlouisfed.org/series/WTISPLC, February 27, 2020") +
scale_x_continuous(labels = scales::dollar) +
scale_y_continuous(labels = scales::percent)
plot(p1)
